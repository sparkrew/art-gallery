<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="https://software-performing.art/" target="_blank" />
    <title>404</title>
    <link rel="stylesheet" href="../../css/style.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.3/addons/p5.sound.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <script src="../../libraries/p5.speech.js"></script>
    <script src="../../libraries/rhill-voronoi-core.js"></script>
  </head>
  <body>
    <main>
      <nav id="nav">
        <ul>
          <li><a href="pages/gallery.html">Gallery</a></li>
          <li><a href="pages/artists/artists.html">Artists</a></li>
          <li><a href="pages/publications.html">Publications</a></li>
          <li><a href="pages/art-history.html">Art History</a></li>
          <li><a href="pages/contact/contact.html">Contact</a></li>
        </ul>
      </nav>
      <div id="error404-container"></div>
    </main>

    <script>
      let size;
      let rows;
      let cols;
      let width;
      let height;
      let boxes = [];
      let font;
      let msg = "404";
      let points = [];
      let fontX;
      let fontY;
      let fontSize;
      let isLetterTab = [];
      let container = document.getElementById("error404-container");

      function preload() {
        font = loadFont("../../assets/fonts/Roboto-Bold.ttf");
      }

      function setup() {
        width = container.offsetWidth;
        height = container.offsetHeight;
        canvas = createCanvas(width, height, WEBGL);
        canvas.parent(container);
        angleMode(DEGREES);
        size = width / 90;
        fontSize = width / 3;
        fontX = -width / 3.2 + 6;
        fontY = height / 3.5 - 12;
        cols = width / size;
        rows = height / size;

        points = font.textToPoints(msg, fontX, fontY, fontSize);
        textAlign(CENTER, CENTER);

        for (let i = 0; i < cols; i++) {
          boxes[i] = [];
          isLetterTab[i] = [];
          for (let j = 0; j < rows; j++) {
            let bx = size / 2 + i * size * 1.2 - (size * cols) / 2;
            let by = size / 2 + j * size * 1.2 - (size * rows) / 2;
            boxes[i][j] = new Box(bx, by);
            isLetterTab[i][j] = false;
          }
        }

        for (let k = 0; k < points.length; k++) {
          let px = points[k].x;
          let py = points[k].y;

          for (let i = 0; i < cols; i++) {
            for (let j = 0; j < rows; j++) {
              let bx = boxes[i][j].x;
              let by = boxes[i][j].y;

              if (dist(px, py, bx, by) < 13.5) {
                isLetterTab[i][j] = true;
              }
            }
          }
        }
      }

      function draw() {
        background(251, 46, 15);
        /* fill(0, 0, 0);
  for (let i = 0; i < points.length; i++) {
    ellipse(points[i].x, points[i].y, 10, 10);
  } */
        for (let i = 0; i < cols; i++) {
          for (let j = 0; j < rows; j++) {
            boxes[i][j].isLetter = isLetterTab[i][j];
            boxes[i][j].display();
          }
        }
      }
      class Box {
        constructor(x, y) {
          this.x = x;
          this.y = y;
          this.isLetter = false;
          this.angle = 0;
          this.depth = 0;
        }

        display() {
          stroke(255, 100);
          noFill();
          if (this.isLetter == true) {
            stroke(255);
            this.depth += 1;
            this.angle += 1;
          } else {
            this.angle -= 1;
          }

          push();
          translate(this.x, this.y, this.depth);
          rotateX(this.angle);
          rotateZ(this.angle);
          box(size - (1 / 3) * size);
          pop();
        }
      }
      function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
      }
    </script>
  </body>
</html>
